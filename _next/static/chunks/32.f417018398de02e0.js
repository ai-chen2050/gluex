"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[32],{6032:function(e,a,n){n.r(a),n.d(a,{default:function(){return p},fetchAllTotalGoals:function(){return l}});var t=n(29),o=n(7794),r=n.n(o),i=n(9828),u=JSON.parse('{"address":"6ExBjE2VPbP8YZhWoXuBgSac5MHS3J8dfviUFuUeBqZe","metadata":{"name":"gluex","version":"0.1.0","spec":"0.1.0","description":"Created with Anchor"},"instructions":[{"name":"add_donation","discriminator":[95,40,48,151,28,22,60,126],"accounts":[{"name":"fee_pool","writable":true,"pda":{"seeds":[{"kind":"const","value":[103,108,117,101,120,45,102,101,101,45,112,111,111,108]}]}},{"name":"donor","writable":true,"signer":true}],"args":[{"name":"amount","type":"u64"},{"name":"currency","type":"string"}]},{"name":"add_maintainer","discriminator":[58,137,30,214,212,175,183,203],"accounts":[{"name":"fee_pool","writable":true,"pda":{"seeds":[{"kind":"const","value":[103,108,117,101,120,45,102,101,101,45,112,111,111,108]}]}},{"name":"founder","signer":true}],"args":[{"name":"maintainer","type":"pubkey"}]},{"name":"claim_unused","discriminator":[124,236,21,199,101,61,78,61],"accounts":[{"name":"goals","writable":true,"pda":{"seeds":[{"kind":"const","value":[103,108,117,101,120,45,103,111,97,108,115]},{"kind":"account","path":"goals.issuer","account":"TotalGoal"},{"kind":"account","path":"goals.taker","account":"TotalGoal"}]}},{"name":"issuer","writable":true,"signer":true}],"args":[]},{"name":"create_fee_pool","discriminator":[181,227,61,52,198,41,25,65],"accounts":[{"name":"fee_pool","writable":true,"pda":{"seeds":[{"kind":"const","value":[103,108,117,101,120,45,102,101,101,45,112,111,111,108]}]}},{"name":"payer","writable":true,"signer":true},{"name":"system_program","address":"11111111111111111111111111111111"}],"args":[{"name":"founder","type":"pubkey"}]},{"name":"distribute_fees","discriminator":[120,56,27,7,53,176,113,186],"accounts":[{"name":"fee_pool","writable":true,"pda":{"seeds":[{"kind":"const","value":[103,108,117,101,120,45,102,101,101,45,112,111,111,108]}]}},{"name":"founder_dest","writable":true}],"args":[]},{"name":"review_subgoal","discriminator":[221,94,97,70,217,114,201,12],"accounts":[{"name":"goals","writable":true,"pda":{"seeds":[{"kind":"const","value":[103,108,117,101,120,45,103,111,97,108,115]},{"kind":"account","path":"goals.issuer","account":"TotalGoal"},{"kind":"account","path":"goals.taker","account":"TotalGoal"}]}},{"name":"issuer","signer":true},{"name":"taker_account","writable":true}],"args":[{"name":"subgoal_index","type":"u8"},{"name":"approve","type":"bool"}]},{"name":"set_fee_params","discriminator":[217,73,193,227,183,14,200,188],"accounts":[{"name":"fee_pool","writable":true,"pda":{"seeds":[{"kind":"const","value":[103,108,117,101,120,45,102,101,101,45,112,111,111,108]}]}},{"name":"founder","signer":true}],"args":[{"name":"numerator","type":"u64"},{"name":"denominator","type":"u64"}]},{"name":"setup_goal","discriminator":[171,112,224,9,171,187,146,248],"accounts":[{"name":"goals","writable":true,"pda":{"seeds":[{"kind":"const","value":[103,108,117,101,120,45,103,111,97,108,115]},{"kind":"account","path":"payer"},{"kind":"arg","path":"taker"}]}},{"name":"payer","writable":true,"signer":true},{"name":"fee_pool","writable":true,"optional":true},{"name":"system_program","address":"11111111111111111111111111111111"}],"args":[{"name":"taker","type":"pubkey"},{"name":"description","type":"string"},{"name":"room","type":{"defined":{"name":"Roomspace"}}},{"name":"relations","type":{"defined":{"name":"Relations"}}},{"name":"eventype","type":{"defined":{"name":"EventType"}}},{"name":"sub_goals","type":{"vec":{"defined":{"name":"SubGoalInput"}}}},{"name":"total_incentive_amount","type":"u64"},{"name":"completion_time","type":"i64"},{"name":"locked_amount","type":"u64"},{"name":"unlock_time","type":"i64"},{"name":"config","type":{"defined":{"name":"GoalConfigInput"}}}]},{"name":"submit_proof","discriminator":[54,241,46,84,4,212,46,94],"accounts":[{"name":"goals","writable":true,"pda":{"seeds":[{"kind":"const","value":[103,108,117,101,120,45,103,111,97,108,115]},{"kind":"account","path":"goals.issuer","account":"TotalGoal"},{"kind":"account","path":"goals.taker","account":"TotalGoal"}]}},{"name":"taker","signer":true}],"args":[{"name":"subgoal_index","type":"u8"},{"name":"proof_uri","type":"string"}]},{"name":"trigger_surprise","discriminator":[186,90,173,71,154,255,243,253],"accounts":[{"name":"goals","writable":true,"pda":{"seeds":[{"kind":"const","value":[103,108,117,101,120,45,103,111,97,108,115]},{"kind":"account","path":"goals.issuer","account":"TotalGoal"},{"kind":"account","path":"goals.taker","account":"TotalGoal"}]}},{"name":"taker_account","writable":true}],"args":[]}],"accounts":[{"name":"FeePool","discriminator":[172,38,77,146,148,5,51,242]},{"name":"TotalGoal","discriminator":[72,64,113,26,170,125,93,94]}],"errors":[{"code":6000,"name":"None"},{"code":6001,"name":"DescExceedMaxChars","msg":"Description exceeds the maximum character limit"},{"code":6002,"name":"RelationsNotSupport","msg":"Relations type is not supported"},{"code":6003,"name":"RoomNotSupport","msg":"Room type is not supported"},{"code":6004,"name":"EventTypeNotSupport","msg":"EventType type is not supported"},{"code":6005,"name":"SubGoalNumExceed","msg":"SubGoal number too many,maximum is five target"},{"code":6006,"name":"PayerAccountInsufficient","msg":"Payer account amount insufficient,account amount must bigger than total_incentive_amount"},{"code":6007,"name":"LockedAmountInvalid","msg":"Locked amount must smaller than total_incentive_amount"},{"code":6008,"name":"SumOfSubgoalAmountInvalid","msg":"The sum of subgoal amount must smaller than total_incentive_amount"},{"code":6009,"name":"UnLockedTimeInvalid","msg":"UnLocked time must bigger than completion time"},{"code":6010,"name":"SubGoalIndexOutOfBounds","msg":"Subgoal index out of bounds"},{"code":6011,"name":"SubGoalAlreadyFinalized","msg":"Subgoal already finalized"},{"code":6012,"name":"ProofAlreadySubmitted","msg":"Proof already submitted for this subgoal"},{"code":6013,"name":"ProofMissing","msg":"Proof submission required before verification"},{"code":6014,"name":"UnauthorizedSigner","msg":"Only issuer can execute this action"},{"code":6015,"name":"UnauthorizedTaker","msg":"Only taker can execute this action"},{"code":6016,"name":"SurpriseTimeNotReached","msg":"Surprise trigger time not reached"},{"code":6017,"name":"UnlockTimeNotReached","msg":"Unlock time not reached"},{"code":6018,"name":"NoFundsAvailable","msg":"No funds available to claim"},{"code":6019,"name":"MissingSubGoals","msg":"Missing subgoals for this event type"},{"code":6020,"name":"HabitConfigInvalid","msg":"Habit configuration is invalid"},{"code":6021,"name":"InvalidCheckpointInterval","msg":"Checkpoint interval must be positive"},{"code":6022,"name":"ParsePubkeyError","msg":"Parse public key error"},{"code":6023,"name":"InvalidSubgoalFormat","msg":"Invalid subgoal format"},{"code":6024,"name":"MaxMaintainersReached","msg":"Maximum number of maintainers reached"},{"code":6025,"name":"MaxDonationsReached","msg":"Maximum number of donations reached"}],"types":[{"name":"DonationEntry","type":{"kind":"struct","fields":[{"name":"donor","type":"pubkey"},{"name":"amount","type":"u64"},{"name":"ts","type":"i64"},{"name":"currency","type":{"array":["u8",8]}}]}},{"name":"EventType","type":{"kind":"enum","variants":[{"name":"HabitTraning"},{"name":"TargetAchieve"},{"name":"SurpriseTime"}]}},{"name":"FeePool","type":{"kind":"struct","fields":[{"name":"founder","type":"pubkey"},{"name":"maintainers","type":{"vec":"pubkey"}},{"name":"protocol_fee_numerator","type":"u64"},{"name":"protocol_fee_denominator","type":"u64"},{"name":"donations","type":{"vec":{"defined":{"name":"DonationEntry"}}}},{"name":"bump","type":"u8"}]}},{"name":"GoalConfigInput","type":{"kind":"struct","fields":[{"name":"start_time","type":"i64"},{"name":"surprise_time","type":"i64"},{"name":"checkpoint_interval","type":"i64"}]}},{"name":"Relations","type":{"kind":"enum","variants":[{"name":"Parents"},{"name":"Lover"},{"name":"Bosstaff"},{"name":"Partner"},{"name":"Dao"}]}},{"name":"Roomspace","type":{"kind":"enum","variants":[{"name":"LoveGame"},{"name":"GroupGame"}]}},{"name":"SubGoal","type":{"kind":"struct","fields":[{"name":"title","type":{"array":["u8",48]}},{"name":"deadline","type":"i64"},{"name":"incentive_amount","type":"u64"},{"name":"status","type":{"defined":{"name":"SubGoalStatus"}}},{"name":"proof_uri","type":{"array":["u8",128]}},{"name":"submitted_at","type":"i64"},{"name":"verifier","type":"pubkey"},{"name":"auto_release_at","type":"i64"},{"name":"is_active","type":"bool"}]}},{"name":"SubGoalInput","type":{"kind":"struct","fields":[{"name":"title","type":"string"},{"name":"deadline","type":"i64"},{"name":"incentive_amount","type":"u64"},{"name":"auto_release_at","type":"i64"}]}},{"name":"SubGoalStatus","type":{"kind":"enum","variants":[{"name":"Pending"},{"name":"ProofSubmitted"},{"name":"Approved"},{"name":"Rejected"},{"name":"Paid"}]}},{"name":"TotalGoal","type":{"kind":"struct","fields":[{"name":"issuer","type":"pubkey"},{"name":"taker","type":"pubkey"},{"name":"description","type":"string"},{"name":"room","type":{"defined":{"name":"Roomspace"}}},{"name":"relations","type":{"defined":{"name":"Relations"}}},{"name":"eventype","type":{"defined":{"name":"EventType"}}},{"name":"sub_goals","type":{"array":[{"defined":{"name":"SubGoal"}},5]}},{"name":"active_sub_goals","type":"u8"},{"name":"total_incentive_amount","type":"u64"},{"name":"deposited_amount","type":"u64"},{"name":"released_amount","type":"u64"},{"name":"completion_time","type":"i64"},{"name":"locked_amount","type":"u64"},{"name":"unlock_time","type":"i64"},{"name":"start_time","type":"i64"},{"name":"surprise_trigger_ts","type":"i64"},{"name":"checkpoint_interval","type":"i64"},{"name":"completed_count","type":"u8"},{"name":"failed","type":"bool"},{"name":"bump","type":"u8"}]}}]}'),s=n(8351),c=n(8764).Buffer;function m(e,a){(null==a||a>e.length)&&(a=e.length);for(var n=0,t=Array(a);n<a;n++)t[n]=e[n];return t}function l(e){return d.apply(this,arguments)}function d(){return(d=(0,t.Z)(r().mark(function e(a){var n,t,o,l,d,p,y,f,g,b,v,k,_,h,w;return r().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return",[]);case 2:n=a.provider.connection,t=a.programId,o=null;try{o=new i.$r(u,a.provider)}catch(e){console.warn("old IDL not available, fallback decode will be skipped",e)}l=null,e.prev=7,null!=(p=null===(d=s.accounts)||void 0===d?void 0:d.find(function(e){return"TotalGoal"===e.name}))&&p.discriminator&&(l=Uint8Array.from(p.discriminator)),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(7),console.warn("Failed to get discriminator from IDL",e.t0),e.abrupt("return",[]);case 17:if(l){e.next=20;break}return console.warn("Discriminator not available"),e.abrupt("return",[]);case 20:return y=function(e,a){if(e.length!==a.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==a[n])return!1;return!0},e.next=23,n.getProgramAccounts(t);case 23:f=e.sent,g=[],console.log("Fetched ".concat(f.length," accounts for program ").concat(t.toBase58())),b=function(e,a){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,a){if(e){if("string"==typeof e)return m(e,a);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,a)}}(e))){n&&(e=n);var t=0,o=function(){};return{s:o,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){u=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(u)throw r}}}}(f),e.prev=27,b.s();case 29:if((v=b.n()).done){e.next=61;break}if(_=(k=v.value).pubkey,h=k.account.data instanceof c?k.account.data:c.from(k.account.data),y(new Uint8Array(h.slice(0,8)),l)){e.next=37;break}return e.abrupt("continue",59);case 37:return w=null,e.prev=38,w=a.coder.accounts.decode("totalGoal",h),g.push({publicKey:_,account:w}),e.abrupt("continue",59);case 44:if(e.prev=44,e.t1=e.catch(38),!o){e.next=58;break}return e.prev=47,w=o.coder.accounts.decode("totalGoal",h),g.push({publicKey:_,account:w}),e.abrupt("continue",59);case 53:e.prev=53,e.t2=e.catch(47),console.warn("Failed to decode account ".concat(_.toBase58()," with both new and old IDLs."),"New IDL error: ".concat((null===e.t1||void 0===e.t1?void 0:e.t1.message)||String(e.t1),"."),"Old IDL error: ".concat((null===e.t2||void 0===e.t2?void 0:e.t2.message)||String(e.t2)));case 56:e.next=59;break;case 58:console.warn("Failed to decode account ".concat(_.toBase58()," with new IDL and old IDL not available:"),e.t1);case 59:e.next=29;break;case 61:e.next=66;break;case 63:e.prev=63,e.t3=e.catch(27),b.e(e.t3);case 66:return e.prev=66,b.f(),e.finish(66);case 69:return console.log("Successfully decoded ".concat(g.length," TotalGoal accounts")),e.abrupt("return",g);case 71:case"end":return e.stop()}},e,null,[[7,13],[27,63,66,69],[38,44],[47,53]])}))).apply(this,arguments)}var p=l}}]);